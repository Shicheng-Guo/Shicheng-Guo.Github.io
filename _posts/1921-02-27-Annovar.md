---
layout: post
title: "How to install ANNOVAR in DeepThought@UW-Madison"
author: Shicheng Guo
date: 1921-02-28
categories: bioinformatics
tags: Genetics Genomics GWAS PostGWAS ANNOVAR
---
1, download ANNOVAR: [http://annovar.openbioinformatics.org/en/latest/user-guide/download/](http://annovar.openbioinformatics.org/en/latest/user-guide/download/)

```
cd ~/tools/annovar
annotate_variation.pl -buildver hg19 -downdb cytoBand humandb/
annotate_variation.pl -buildver hg19 -downdb -webfrom annovar refGene humandb/

# just for allele frequency
# annotate_variation.pl -downdb -webfrom annovar exac03 humandb -buildver hg38  &
# annotate_variation.pl -downdb -webfrom annovar esp6500siv2 humandb -buildver hg38 &
annotate_variation.pl -downdb -webfrom annovar esp6500siv2_all humandb -buildver hg38 &
annotate_variation.pl -downdb -webfrom annovar gnomad_exome humandb -buildver hg38 &

# whole-exome data
annotate_variation.pl -downdb -webfrom annovar 1000g2015aug humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar kaviar_20150923 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar hrcr1 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar cg69 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar gnomad_genome humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar dbnsfp30a humandb -buildver hg38 &
annotate_variation.pl -downdb -webfrom annovar esp6500siv2 humandb -buildver hg38 &
annotate_variation.pl -downdb esp6500siv2 humandb -buildver hg38 &

# whole-genome data
annotate_variation.pl -downdb -webfrom annovar gerp++ humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar cadd humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar cadd13 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar fathmm humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar eigen humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar gwava humandb -buildver hg38  &

# CNV
annotate_variation.pl -downdb -webfrom annovar dbscsnv11 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar spidex humandb -buildver hg38  &

# disease-specific variants
annotate_variation.pl -downdb -webfrom annovar clinvar_20160302 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar cosmic70 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar icgc21 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar nci60 humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar dbnsfp35c humandb -buildver hg38  &
annotate_variation.pl -downdb -webfrom annovar dbnsfp33a humandb -buildver hg19  &
annotate_variation.pl -downdb -webfrom annovar dbnsfp35a humandb -buildver hg19  &
annotate_variation.pl -downdb -webfrom annovar dann humandb --buildver hg38 &
annotate_variation.pl -downdb -webfrom annovar dann humandb --buildver hg19 &
annotate_variation.pl -downdb -webfrom annovar ljb23_all humandb --buildver hg19&

# GWAS
annotate_variation.pl -buildver hg38 -downdb -webfrom annovar gwasCatalog humandb/ &
annotate_variation.pl -buildver hg38 -downdb  tfbsConsSites humandb/ 
annotate_variation.pl -buildver hg38 -downdb -webfrom annovar wgRna humandb/ &
annotate_variation.pl -buildver hg38 -downdb targetScanS humandb/ 
annotate_variation.pl -downdb -webfrom annovar dann humandb --buildver hg38 &
annotate_variation.pl -buildver hg38 -downdb  tfbsConsSites humandb/ 
annotate_variation.pl -buildver hg38 -downdb  tfbsConsSites humandb/ 
annotate_variation.pl -buildver hg38 -downdb -webfrom annovar gnomad_genome humandb/ 
annotate_variation.pl -buildver hg38 -downdb -webfrom ucsc gnomad_genome humandb/ 
```
2, ANNOVAR now takes VCF as standard input
```
bcftools view -G Final.vcf.gz --threads 32 -Ov -o avinput.vcf
table_annovar.pl -vcfinput avinput.vcf ~/tools/annovar/humandb/ --thread 12 -buildver hg19 -out myanno -remove -protocol refGene,dbnsfp33a -operation gx,f -nastring . -otherinfo -polish -xref ~/tools/annovar/humandb/gene_fullxref.txt
```
3, SNP distribution patterns, how many intergenic? how many exomic? 
```
bcftools view -G Final.vcf.gz --threads 32 -Ov -o avinput.vcf
table_annovar.pl -vcfinput avinput.vcf ~/tools/annovar/humandb/ --thread 12 -buildver hg19 -out myanno -remove -protocol refGene,dbnsfp33a -operation gx,f -nastring . -otherinfo -polish -xref ~/tools/annovar/humandb/gene_fullxref.txt

data<-read.table("c1",as.is=T)
anno<-data[,1]
anno[anno=="ncRNA_UTR5"]<-"ncRNA_exonic"
anno[anno=="ncRNA_exonic;splicing"]<-"ncRNA_exonic"
anno[anno=="exonic;splicing"]<-"splicing"
anno[anno=="UTR5;UTR3"]<-"exonic"
anno[anno=="ncRNA_splicing"]<-"splicing"
anno[anno=="upstream;downstream"]<-"intergenic"
input<-table(anno)
pdf("pie.annovar.pdf")
pie(input,col=rainbow(length(input)),main="N=13,494,289 SNPs")
dev.off()
```
4, Distance distribution to exome regions? 
```
perl -lane '{print $1 if /dist=(\d+)/}' myanno.refGene.variant_function > dist

data<-read.table("dist",as.is=T)
anno<-data[,1]
pdf("dist.annovar.pdf")
hist(anno,col=rainbow(20),main="N=13,494,289 SNPs")
dev.off()
```




